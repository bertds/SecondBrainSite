<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- IBM Plex Mono -->
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap" rel="stylesheet">
  <!-- IBM Plex Sans -->
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,600;0,700;1,300;1,400;1,600;1,700&display=swap" rel="stylesheet">

  <!-- CSS (uses absolute weblinks to work around relative path issues) -->
  <link rel="stylesheet" type="text/css" href="https://www.kmaasrud.com/main.css">
  <link rel="stylesheet" type="text/css" href="https://www.kmaasrud.com/brain/main.css">


</head>

<body>

  <div class="grid">
    <nav>
      <ul>
        <br>
        <li><a href="https://bertds.github.io/SecondBrainSite/">Second Brain</a></li>
        <br>
      </ul>
    </nav>
    <article>
      <div id="content"><h1 id="early-stopping">Early stopping</h1>

<p>Tags: <span class="tag">AI</span> <span class="tag">andere</span><br />
Date: 2021-03-06<br />
Type: <a href="cursus-topic.html">Cursus topic</a><br />
Related: <!-- Links to pages not referenced in the content --><br />
Source : </p>

<h2 id="notities">Notities</h2>

<p>Hoelang moet je NN trainen ? Te kort dan krijgt NN niet genoeg tijd om alles te capteren. Te lang heb je kans op overfitting?<br />
*Hoe kan je ervoor zorgen dat je het optimaal aantal epochs kunt bepalen om een optimale accuracy en loss te hebben voor test en trainingset ? *</p>

<p>We splitsen onze data in test en trainingsset en trainen een NN.<br />
<img src="Screenshot 2021-03-06 at 11.55.40.png" alt="Screenshot 2021-03-06 at 11.55.40.png" /></p>

<h4 id="overfitting">overfitting</h4>

<p>Als model traint dan is het model op een gegeven moment in staat om een accuraatheid van 100% te halen. Het model kent alle trainingsamples van buiten.<br />
<img src="Screenshot 2021-03-06 at 11.46.09.png" alt="Screenshot 2021-03-06 at 11.46.09.png" /><br />
Vanaf 200 epochs zien we dat loss op test set terug naar boven gaat terwijl die op trainingset verder blijft dalen. Dit typisch als het NN teken van overfitting begint te vertonen. Het NN wordt overtraind. </p>

<h4 id="early-stopping-2">early stopping</h4>

<p><img src="Screenshot 2021-03-06 at 11.57.17.png" alt="Screenshot 2021-03-06 at 11.57.17.png" /><br />
Oplossing is early stopping.  Nadeel is dat training te vroeg afgebroken kan zijn doordat NN op een plateau terecht is gekomen. </p>

<h4 id="patience">patience</h4>

<p><img src="Screenshot 2021-03-06 at 11.59.01.png" alt="Screenshot 2021-03-06 at 11.59.01.png" /><br />
Met patience toch nog een beetje verder trainen om zeker te zijn dat we niet op een plateau zitten. Nadeel is dat we de modelwaarden van het minimum niet hebben. </p>

<h4 id="model-checkpoints">model checkpoints</h4>

<p><img src="Screenshot 2021-03-06 at 12.03.10.png" alt="Screenshot 2021-03-06 at 12.03.10.png" /><br />
Oplossing hiervoor is model checkpoints dat je nadien terug kan opvragen.<br />
<img src="Screenshot 2021-03-06 at 12.03.43.png" alt="Screenshot 2021-03-06 at 12.03.43.png" /></p>

<h2 id="vragen">Vragen</h2>

<p>Q: Waarom moet je niet stoppen met trainen bij een NN als tijdens het trainen de loss na een paar epochs niet meer zakt ?<br />
A: Omdat je model op een plateau kan zitten en dat je nog niet op het optimaal minimum zit van de loss.<br />
<!--ID: 1615027118250--></p>

<p>Q: Wat is early stopping bij het trainen van een NN ?<br />
A: Dit is het vroegtijdig afbreken van de training obv de loss die mogelijk een optimaal minimum bereikt heeft.<br />
<!--ID: 1615027118257--></p>

<p>Q: Hoe kan je ervoor zorgen dat bij het trainen van een NN dat Early stopping toch nog wat verder zoekt ?<br />
A: Je kan patience toevoegen bij het trainen van een NN model en pas als die voorbij zijn stopt het model met trainen als blijkt dat de loss niet meer zakt tijdens die patience.<br />
<!--ID: 1615027118263--></p>

<p>Q: Wat is een mogelijk nadeel van patience te gebruiken bij het trainen van een NN ? Hoe los je dit op ?<br />
A: Probleem bij het gebruik van patience bij het trainen van een NN is dat de loss terug gestegen kan zijn na een minimum bereikt te hebben. Hierdoor heb je na de patience een model dat slechter scroot dan je zou gehad hebben door early stopping. Oplossing hiervoor is om met model checkpoint te werken en een checkpoint te laten nemen van het model op het ogenblik dat het een minimum bereikt heeft. Deze checkpoint bevat dan de waarden van de weights en biases van het NN op het ogenblik van het loss minimum.<br />
<!--ID: 1615027118271--></p>
</div>

      <div class="backlinks">

<ul>
<li><a href="ai-home.html">AI@home</a></li>
<li><a href="hands-on-with-keras-and-tensforflow.html">Hands-on with Keras and Tensforflow</a></li>
</ul>

</div>


    </article>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script>
   mermaid.initialize();
  </script>

  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
    integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

  <!-- The loading of KaTeX is deferred to speed up page rendering -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
    integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
    crossorigin="anonymous"></script>

  <!-- To automatically render math in text elements, include the auto-render extension: -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI"
    crossorigin="anonymous"></script>

  <!-- Parsing single dollar signs -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
          {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false}
        ]
    });
    });
  </script>

  <!-- Syntax highlighting through highlight.js -->
  <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.4.0/styles/default.min.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@10.4.0/highlight.min.js"></script>

  <script>
    // Ignore highlighting of mermaid
    hljs.configure({noHighlightRe: /^mermaid$/});
    hljs.initHighlightingOnLoad();
  </script>

</body>

</html>
