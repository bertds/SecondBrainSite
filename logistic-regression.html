<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- IBM Plex Mono -->
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap" rel="stylesheet">
  <!-- IBM Plex Sans -->
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,600;0,700;1,300;1,400;1,600;1,700&display=swap" rel="stylesheet">

  <!-- CSS (uses absolute weblinks to work around relative path issues) -->
  <link rel="stylesheet" type="text/css" href="https://www.kmaasrud.com/main.css">
  <link rel="stylesheet" type="text/css" href="https://www.kmaasrud.com/brain/main.css">


</head>

<body>

  <div class="grid">
    <nav>
      <ul>
        <br>
        <li><a href="https://bertds.github.io/SecondBrainSite/">Second Brain</a></li>
        <br>
      </ul>
    </nav>
    <article>
      <div id="content"><h1 id="logistic-regression">Logistic Regression</h1>

<p>Tags: <span class="tag">AI</span><br />
Date: 2020-12-30<br />
Type: <a href="cursus-topic.html">Cursus topic</a><br />
Related: <!-- Links to pages not referenced in the content --><br />
Source :<br />
Questions : <a href="q-logistic-regression.html">Q Logistic Regression</a></p>

<p><a href="ai-journey-/classification.html">AI journey ðŸ§ /Classification</a><br />
<a href="classificatie.html">Classificatie</a></p>

<h2 id="het-model">Het model</h2>

<p>$h_\theta(X)$ moet voldoen aan : $$0 \le h_\theta(X) \le 1$$</p>

<ul>
<li>$h_\theta(X)$ = de geschatte kans dat y=1 bij input x</li>
<li>voorbeeld : $h_\theta(x)$ = 0.80<br />
het model is voor 80% zeker dat het om een appel gaat</li>
</ul>

<p><img src="logreg_appel.png" alt="logreg_appel.png" /><br />
<img src="logregappel2.png" alt="logregappel2.png" /><br />
<img src="logregappel3.png" alt="logregappel3.png" /><br />
<img src="logregappel4.png" alt="logregappel4.png" /><br />
<img src="logregappel5.png" alt="logregappel5.png" /><br />
<img src="logregappel6.png" alt="logregappel6.png" /><br />
<img src="logregappel7.png" alt="logregappel7.png" /></p>

<h3 id="processing">Processing</h3>

<ul>
<li>Data inlezen  </li>
<li>Check op inconsistenties  </li>
<li>Check uitschieters</li>
<li>Plot de data  </li>
<li>Splits op in features en targets  </li>
<li>Verdeel in een training en test set</li>
<li>trainen van logistic regression model</li>
<li>classificeren van nieuwe sample</li>
<li>visualiseer de decision boundary</li>
</ul>

<h3 id="feature-engineering">Feature engineering</h3>

<p>niet lineair scheidbare dataset &gt; hogere orde features toevoegen met PolynomialFeatures()<br />
 <img src="logreg_featureng3.png" alt="logreg_featureng3.png" /></p>

<p><img src="logreg_featureng2.png" alt="logreg_featureng2.png" /></p>

<h3 id="underfitting-en-overfitting">Underfitting en overfitting</h3>

<p>Via regularisatie een goed evenwicht zoeken tussen <span class="tag">underfitting</span> en <span class="tag">overfitting</span><br />
In Scikit Learn linear_model.LogisticRegression</p>

<p>C = inverse regularisatie sterkte</p>

<ul>
<li>kleine waarden voor C zorgen voor een sterke regularisatie (underfitting)</li>
<li>grote waarden voor C zorgen voor een zwakke regularisatie (overfitting)</li>
</ul>

<p><img src="logreg_featureng1.png" alt="logreg_featureng1.png" /></p>

<h3 id="multi-class-classification">Multi-class classification</h3>

<h4 id="one-vs-all">One-vs-All</h4>

<p>classificatie per category :</p>

<ul>
<li>gevoeliger voor niet gebalanceerde data</li>
</ul>

<p><img src="logreg_multiclass1.png" alt="logreg_multiclass1.png" /></p>

<h4 id="one-vs-one">one-vs-one</h4>

<p>$\frac{N (N-1)}{2}$ classifiers (N klasses) :</p>

<ul>
<li>rekenintensief</li>
<li>minder gevoelig voor niet gebalanceerde data</li>
</ul>

<p><img src="logreg_multiclass2.png" alt="logreg_multiclass2.png" /></p>

<h3 id="evaluatie-classifier">Evaluatie classifier</h3>

<h4 id="confusion-matrix"><strong>confusion matrix</strong></h4>

<table>
<thead>
<tr>
  <th>CM</th>
  <th>P' (predicted)</th>
  <th>n' (predicted)</th>
</tr>
</thead>
<tbody>
<tr>
  <td>P (actual)</td>
  <td>True positive</td>
  <td>False negative</td>
</tr>
<tr>
  <td>n (actual)</td>
  <td>False positive</td>
  <td>True negavtive</td>
</tr>
</tbody>
</table>

<p><img src="evalclassifier1.png" alt="evalclassifier1.png" /></p>

<p>Accuracy = $\dfrac{TP + TN}{TP + FP + FN + TN}$</p>

<p>Recall = $\dfrac{TP}{TP + FN}$</p>

<p>Precision = $\dfrac{TP}{TP + FP}$</p>

<p>F1 score = $\dfrac{2 * (Recall * Precision)}{Recall + Precision}$</p>

<p><img src="evalclassifier2.png" alt="evalclassifier2.png" /></p>

<h3 id="niet-gebalanceerde-data">Niet gebalanceerde data</h3>

<p><img src="ai-journey-/niet-gebalanceerde-data.html" alt="AI journey ðŸ§ /Niet gebalanceerde data" /></p>

<h3 id="roc">ROC</h3>

<p>recall = sensitivity<br />
ROC (Receiver Operating Characteristic) -> evalueren binaire classifier<br />
<img src="ROC1.png" alt="ROC1.png" /><br />
<img src="ROC2.png" alt="ROC2.png" /><br />
TPR (True Positive Rate) stijgt<br />
FPR (False Positive Rate) daalt</p>

<p>Als we de treshold aanpassen dan zien we voor 0.5 :<br />
<img src="ROC3.png" alt="ROC3.png" /></p>

<p>en voor 0.6 zien we dat de accuracy beter wordt (TPR gelijk, FPR daalt) :<br />
<img src="ROC4.png" alt="ROC4.png" /></p>

<p>dit doen we voor verschillende treshold waarden en krijgen zo de ROC-curve.<br />
En hieruit ook de auROC (Area under ROC)<br />
<img src="ROC5.png" alt="ROC5.png" /></p>

<p>Hoe hoger auROC hoe beter het model is. (lagere FPR, hogere TPR)<br />
Om ROC curve te kunnen gebruiken moet je wel met probabiliteiten kunnen werken (ook bij logreg) met je classificatie. </p>
</div>

      <div class="backlinks">

<ul>
<li><a href="ai-home.html">AI@home</a></li>
<li><a href="classification.html">Classification</a></li>
<li><a href="q-classification.html">Q Classification</a></li>
<li><a href="q-logistic-regression.html">Q Logistic Regression</a></li>
</ul>

</div>


    </article>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script>
   mermaid.initialize();
  </script>

  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
    integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

  <!-- The loading of KaTeX is deferred to speed up page rendering -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
    integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
    crossorigin="anonymous"></script>

  <!-- To automatically render math in text elements, include the auto-render extension: -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI"
    crossorigin="anonymous"></script>

  <!-- Parsing single dollar signs -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
          {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false}
        ]
    });
    });
  </script>

  <!-- Syntax highlighting through highlight.js -->
  <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.4.0/styles/default.min.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@10.4.0/highlight.min.js"></script>

  <script>
    // Ignore highlighting of mermaid
    hljs.configure({noHighlightRe: /^mermaid$/});
    hljs.initHighlightingOnLoad();
  </script>

</body>

</html>
