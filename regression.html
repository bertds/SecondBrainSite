<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- IBM Plex Mono -->
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap" rel="stylesheet">
  <!-- IBM Plex Sans -->
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,600;0,700;1,300;1,400;1,600;1,700&display=swap" rel="stylesheet">

  <!-- CSS (uses absolute weblinks to work around relative path issues) -->
  <link rel="stylesheet" type="text/css" href="https://www.kmaasrud.com/main.css">
  <link rel="stylesheet" type="text/css" href="https://www.kmaasrud.com/brain/main.css">


</head>

<body>
  <div class="grid">
    <nav>
      <ul>
        <a href="https://www.kmaasrud.com/brain"><img id="logo" src="https://raw.githubusercontent.com/kmaasrud/brain/master/brain.svg"></img></a>
        <br>
        <li><a href="https://www.kmaasrud.com/projects">Projects</a></li>
        <li><a href="https://github.com/kmaasrud">GitHub</a></li>
        <br>
      </ul>
    </nav>
    <article>
      <div class="backlinks">

<ul>
<li><a href="ai-home">AI@home</a></li>
</ul>

</div>


      <div id="content"><h1 id="lineaire-regressie">Lineaire regressie</h1>

<p>Tags: <span class="tag">AI</span><br />
Date: 2020-11-21<br />
Type: <a href="cursus-topic">Cursus topic</a><br />
Related: <!-- Links to pages not referenced in the content --><br />
Source :</p>

<h2 id="notities">Notities</h2>

<h4 id="enkelvoudige-linaire-regressie">Enkelvoudige linaire regressie</h4>

<ul>
<li>rechte die het dichtst bij alle punten ligt</li>
<li>mbv <a href="kostenfunctie">kostenfunctie</a> bepalen welke parameters de beste zijn</li>
<li>die parameters zoeken we met <a href="gradient-descent">gradient descent</a></li>
<li><a href="learning-rate">learning rate</a> grote stappen is beter dan kleine stappen (dan duurt het lang om het optimaal punt te vinden) maar je kan over je optimaal punt stappen door dei grote stappen</li>
</ul>

<h4 id="meervoudige-lineaire-regressie">Meervoudige lineaire regressie</h4>

<ul>
<li>meerdere features</li>
<li><a href="stappenplan-dataanalyse">stappenplan dataanalyse</a><br />
<ul><br />
<li>statistische voor analyse<br /><br />
<ul><br /><br />
<li>onderlinge correlaties zoeken mbv <a href="heatmap">heatmap</a> :<br /><br /><br />
<ul><br /><br /><br />
<li>+1: linair verband tss features ene omhoog en andere omhoog</li><br /><br /><br />
<li>-1 : lineair verband tss features ene omhoog en andere omlaag</li><br /><br /><br />
</ul></li><br /><br />
<li>verhoudig tss features bekijken via <a href="pairplot">pairplot</a>:</li><br /><br />
</ul></li><br />
<li>data opsplisten in training en testset:<br /><br />
<ul><br /><br />
<li>randomize om alle cases te kunnen trainen</li><br /><br />
<li>soms geen randomize mogelijk omdat volgorde van belang is (tijdreeks)</li><br /><br />
</ul></li><br />
<li>testen van het model: (hiermee kunnen modellen vergeleken worden)<br /><br />
<ul><br /><br />
<li><a href="mae">MAE</a> mean absolute error</li><br /><br />
<li><a href="mse">MSE</a> mean squared error &gt; extreme cases slechter laten scoren</li><br /><br />
<li><a href="r2">R2</a> determinatiecoëfficient &gt; score zo dicht mogelijk bij 1</li><br /><br />
</ul></li><br />
</ul></li>
</ul>

<h4 id="feature-engineering">Feature Engineering</h4>

<ul>
<li>normalisatie = features op dezelfde schaal brengen <a href="scalers">scalers</a><br />
<ul><br />
<li>min-max scaler</li><br />
<li>standard scaler</li><br />
<li>robust scaler</li><br />
</ul></li>
<li>nieuwe features toevoegen<br />
<ul><br />
<li>manueel kwadraat feature toevoegen</li><br />
<li>combinatie van features maken</li><br />
</ul></li>
<li>hogere orde features<br />
<ul><br />
<li>feature in kwadraat, tot de 3de, 4de macht</li><br />
</ul></li>
<li><a href="one-hot-encoding">one hot encoding</a>:<br />
<ul><br />
<li>omzetten van label naar aparte features</li><br />
</ul></li>
</ul>

<h4 id="underfitting-overfitting">Underfitting, Overfitting</h4>

<ul>
<li>underfitting<br />
<ul><br />
<li>model kan de trainingsdata niet modelleren</li><br />
<li>en ook niet generaliseren op nieuwe data</li><br />
<li>model is te eenvoudig</li><br />
</ul></li>
<li>overfitting<br />
<ul><br />
<li>model benadert de trainingsdata te goed - scoort heel goed</li><br />
<li>maar scoort slechter op de testdata</li><br />
<li>model is te complex</li><br />
<li>als er veel features zijn dan is het moeilijker om overfitting te krijgen</li><br />
</ul></li>
<li><p><a href="regularisatie">regularisatie</a></p>

<ul>
<li>L1 regularisatie : absolute waarde</li>
<li>L2 regularisatie : kwadraat</li>
<li><p>hyperparameter tuning:</p>

<ul>
<li>waarden voor alpha 10000 wijst op underfitting. vooral het feit dat trainingsset slecht scoort wijst hierop.  </li>
<li><p>waarden voor ahpha 0.01 wijst op overfitting en L2 score voor test set wijst erop dat het slechter scoort dan de gemiddelde prijs</p>

<table>
<thead>
<tr>
  <th></th>
  <th>$\alpha$  = 10000</th>
  <th>$\alpha$  = 0.01</th>
  <th>$\alpha$  = 20</th>
</tr>
</thead>
<tbody>
<tr>
  <td>R2 score op test L2</td>
  <td>0.29</td>
  <td>-1.31</td>
  <td>0.80</td>
</tr>
<tr>
  <td>R2 score op training L2</td>
  <td>0.29</td>
  <td>0.99</td>
  <td>0.95</td>
</tr>
</tbody>
</table>

<h4 id="opsporen-van-uitschieters">Opsporen van uitschieters</h4></li>
</ul></li>
</ul></li>
</ul>

<p>uitschieters niet altijd te bepalen obv 1 feature op zich maar een combinatie van features (die soms zeer zeldzaam zijn !)</p>

<ul>
<li>naïeve manier:<br />
<ul><br />
<li>uitzonderlijke waarden van 1 feature  &gt; waardoor die ver verwijderd zijn van gemiddelde waarde</li><br />
<li>data kuisen door alls selectreren binnen de 5 standaardafwijkingen rond het gemiddelde</li><br />
<li>MAAR extreme waarden erin laten indien ze geen gevolg zijn van fouten (sensoren die niet goed waren, type fouten, ...)</li><br />
</ul></li>
</ul>

<h4 id="correlatie-matrix">Correlatie matrix</h4>

<p>X / y<br />
    - positief : positieve correlatie tss feature en gewenst resultaat<br />
    - negatief : negatieve correlatie<br />
! geeft enkel linaire samenhang !<br />
onderlinge correlatie van features &gt; als de ene veranderd zal de andere op voorspelbare manier mee veranderen<br />
als je features zou willen weglaten &gt; kijken naar features die weining invloed hebben op target en die sterke correlatie hebben met andere features</p>

<h4 id="pairplotpairplot"><a href="pairplot">pairplot</a></h4>

<ul>
<li>indien je veel data hebt een subset nemen omdat het plotten anders lang duurt</li>
<li>histogram op hoofddiagonaal (scatterplot met zichzelf zou rechte lijn geven)<br />
<ul><br />
<li>geeft aan hoe de waarden van dat feature verdeeld zijn<br /><br />
<ul><br /><br />
<li>welke <a href="scaler">scaler</a> te gebruiken ?<br /><br /><br />
<ul><br /><br /><br />
<li>normaal &gt; standaard scaler</li><br /><br /><br />
<li>veel uitschieters &gt; robust scaler</li><br /><br /><br />
<li>one hot encoding &gt; min max scaler (heel gevoelig aan uitschieters)</li><br /><br /><br />
</ul></li><br /><br />
</ul></li><br />
</ul></li>
<li>andere plots zijn scatterplots</li>
</ul>

<h4 id="coeffcient-getraind-model">coeffcient getraind model</h4>

<ul>
<li>coefficiant = $\theta$ - gewicht van de feature om tot kwaliteitsscore te komen</li>
<li>intercept = $\theta_0$ - constante die altijd aanwezig is</li>
<li>als $\theta_n$ &gt; 0 feature beinvloed target positief</li>
<li>als $\theta_n$ &lt; 0 feature beinvloed target negatief</li>
<li>hogere orde feature toevoegen als lineaire verbanden van features niet gemapt/gekapteerd kunnen worden. hierdoor wel risico dat je complexer model krijgt en dat het dichter bij de trainingsdata gaat aanleunen en je overfitting krijgt.</li>
</ul>

<h4 id="regularisatie">Regularisatie</h4>

<p>Om overfitting tegen te gaan kan je regularisatie gebruiken = term toevoegen aan de kosten functie $+\lambda_1\sum_{j=1}^{n} |\theta_j|$ (als $\theta$ stijgt wordt model afgestraft)<br />
Vermijden dat het model zich vastrijdt in ruis in de data:</p>

<ul>
<li>L1 regularisatie = absolute waarde $\theta$ </li>
<li>L2 regularisatie = kwadraat van $\theta$ -> extreme waarden worden afgestraft</li>
</ul>

<p>!Opgelet! $\theta_0$ = bias wordt NIET geregulariseerd.<br />
Met $\lambda$ bepaal je hoe hard regularisatie meespeelt ($\lambda$ in scikit learn = $\alpha$)</p>

<ul>
<li>$\alpha$ zeer hoog =&gt; alle $\theta$ zeer laag of = 0</li>
<li>$R^2$ score = 0 =&gt; model doet het niet beter dan als predicite steeds het gemiddelde zou zijn</li>
<li>welke waarde voor $\alpha$ ?<br />
<ul><br />
<li>te hoog : underfitting, model te simpel</li><br />
<li>te laag : overfitting</li><br />
<li>bepaling : $\alpha$ laten variëren en $R^2$ score daar tegen zetten =&gt; optimum van $\alpha$ waar $R^2$ voor testset de hoogste waarde heeft</li><br />
</ul></li>
</ul>

<h2 id="vragen">Vragen</h2>

<ul>
<li>5 standaardafwijkingen ?</li>
<li><br />
-</li>
</ul>
</div>

    </article>
  </div>

  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
    integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

  <!-- The loading of KaTeX is deferred to speed up page rendering -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
    integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
    crossorigin="anonymous"></script>

  <!-- To automatically render math in text elements, include the auto-render extension: -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI"
    crossorigin="anonymous"></script>

  <!-- Parsing single dollar signs -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
          {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false}
        ]
    });
    });
  </script>

  <!-- Syntax highlighting through highlight.js -->
  <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.4.0/styles/default.min.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@10.4.0/highlight.min.js"></script>

  <script>
    // Ignore highlighting of mermaid
    hljs.configure({noHighlightRe: /^mermaid$/});
    hljs.initHighlightingOnLoad();
  </script>
</body>

</html>